History ampSum(0.);
//History k(0.);
History ivector(0.);
Buffer barkIndex("barkScale");
Buffer barkAmpli("barkAmp");
Buffer barkBandAmp("barkBandAmp");

overlapCompensation = FFTHOP / (FFTSIZE * .5);

amp = in1 / (VECTORSIZE * .125);
index = in2;

j = 0;
i = ivector;
k = 0;
		
	if (index < (VECTORSIZE - 1)){
	//	k = 0;
		// accumulate while the index is below (vectorsize - 1)
		i = peek(barkIndex,index,0);
		//ii = peek(barkIndex,index-1,0);
		//ampSum = (i == ii) ? ampSum : 0;
		if(i==1){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,1);
		//poke(barkAmpli,ampSum,1,0,0);
		}
		if(i==2){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,2);
		}
		if(i==3){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,3);
		}
		if(i==4){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,4);
		}
		
		if(i==5){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,5);
		}
		if(i==6){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,6);
		}
		if(i==7){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,7);
		}
		if(i==8){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,8);
		}
		if(i==9){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,9);
		}
		if(i==10){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,10);
		}
		if(i==11){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,11);
		}
		if(i==12){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,12);
		}
		if(i==13){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,13);
		}
		if(i==14){
			ampSum = 0;
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,14);
		}
		if(i==15){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,15);
		}
		if(i==16){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,16);
		}
		if(i==17){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,17);
		}
		if(i==18){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,18);
		}
		if(i==19){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,19);
		}
		if(i==20){
			ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,20);
		}
		if(i==21){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,21);
		}
		if(i==22){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,22);
		}
		if(i==23){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,23);
		}
		if(i==24){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,24);
		}
		if(i==25){
		ampSum = 0;
		ampSum += amp;
		poke(barkBandAmp,ampSum,25);
		}	
				
	}
		
	else	
	
	{
		for(j = 0 ; j < 26 ; j+=1){
			
		ampli = peek(barkBandAmp,j,0);
			
		poke(barkAmpli,ampli,j,0,0);
		
		k = (j >= 25) ? 1 : 0;
		
		}
				
	}
	out1 = k;